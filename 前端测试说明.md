# 前端测试说明

## 快速启动前端（推荐）

### 方法一：使用批处理脚本（Windows）

1. **确保后端正在运行**
   ```bash
   node 启动-修复版.js
   ```

2. **启动前端**
   ```bash
   cd client
   双击运行 启动前端.bat
   ```

### 方法二：手动启动

1. **打开新的命令行窗口**
   ```bash
   cd C:\development\GBaseTask\client
   ```

2. **安装依赖**（首次运行）
   ```bash
   npm install
   ```

3. **启动开发服务器**
   ```bash
   npm run dev
   ```

## 访问地址

- 前端界面：http://localhost:3001
- 后端 API：http://localhost:3000

## 测试 API 功能

### 1. 使用浏览器测试

直接在浏览器访问以下地址测试 API：

- 健康检查：http://localhost:3000/health
- API 信息：http://localhost:3000/api
- 任务列表：http://localhost:3000/api/tasks

### 2. 使用 curl 或 Postman 测试

**获取任务列表：**
```bash
curl http://localhost:3000/api/tasks
```

**创建新任务：**
```bash
curl -X POST http://localhost:3000/api/tasks ^
  -H "Content-Type: application/json" ^
  -d "{\"title\":\"测试任务\",\"type\":\"task\",\"status\":\"pending\",\"priority\":\"medium\"}"
```

### 3. 使用 PowerShell 测试

```powershell
# 获取任务列表
Invoke-RestMethod -Uri "http://localhost:3000/api/tasks" -Method Get

# 创建任务
$body = @{
    title = "测试任务"
    type = "task"
    status = "pending"
    priority = "medium"
    description = "这是一个测试任务"
} | ConvertTo-Json

Invoke-RestMethod -Uri "http://localhost:3000/api/tasks" -Method Post -Body $body -ContentType "application/json"
```

## 简化测试方案

如果前端启动有问题，可以使用以下简单的 HTML 页面测试 API：

### 创建 `test-api.html`

```html
<!DOCTYPE html>
<html>
<head>
    <title>API 测试页面</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        button { margin: 10px; padding: 10px; }
        #result { border: 1px solid #ccc; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Lark 任务管理系统 - API 测试</h1>
    
    <button onclick="testHealth()">测试健康检查</button>
    <button onclick="getTasks()">获取任务列表</button>
    <button onclick="createTask()">创建测试任务</button>
    
    <h3>响应结果：</h3>
    <pre id="result">点击按钮测试 API...</pre>

    <script>
        const API_BASE = 'http://localhost:3000';
        
        async function testHealth() {
            const response = await fetch(`${API_BASE}/health`);
            const data = await response.json();
            document.getElementById('result').textContent = JSON.stringify(data, null, 2);
        }
        
        async function getTasks() {
            const response = await fetch(`${API_BASE}/api/tasks`);
            const data = await response.json();
            document.getElementById('result').textContent = JSON.stringify(data, null, 2);
        }
        
        async function createTask() {
            const task = {
                title: '测试任务 ' + new Date().toLocaleTimeString(),
                type: 'task',
                status: 'pending',
                priority: 'medium',
                description: '这是通过测试页面创建的任务'
            };
            
            const response = await fetch(`${API_BASE}/api/tasks`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(task)
            });
            
            const data = await response.json();
            document.getElementById('result').textContent = JSON.stringify(data, null, 2);
        }
    </script>
</body>
</html>
```

将上述代码保存为 `test-api.html`，然后在浏览器中打开即可测试 API。

## 常见问题

### 1. 前端依赖安装失败

如果 npm install 失败，可以尝试：
```bash
# 清理缓存
npm cache clean --force

# 使用淘宝镜像
npm config set registry https://registry.npmmirror.com

# 重新安装
npm install
```

### 2. 端口被占用

如果 3001 端口被占用，可以修改 `client/vite.config.ts`：
```typescript
server: {
  port: 3002,  // 改为其他端口
}
```

### 3. CORS 跨域问题

后端已配置 CORS，如果仍有问题，确保：
- 后端在 http://localhost:3000 运行
- 前端在 http://localhost:3001 运行

## 快速验证

最简单的验证方法：
1. 打开浏览器
2. 访问 http://localhost:3000/health
3. 如果看到 JSON 响应，说明后端正常
4. 访问 http://localhost:3000/api/tasks
5. 如果看到任务列表，说明 API 正常