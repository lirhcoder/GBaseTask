# 修复前端依赖错误

## 错误原因
这是 Vite 和 Rollup 在 Windows 上的一个已知问题，缺少特定平台的二进制文件。

## 解决方案

### 方案一：快速修复（推荐）
```bash
cd client
quick-fix.bat
```

### 方案二：完整清理并重装
```bash
cd client
fix-dependencies.bat
```

### 方案三：手动修复
在 PowerShell 中执行：
```powershell
cd client

# 1. 删除旧文件
Remove-Item node_modules -Recurse -Force -ErrorAction SilentlyContinue
Remove-Item package-lock.json -Force -ErrorAction SilentlyContinue

# 2. 清理缓存
npm cache clean --force

# 3. 重新安装
npm install

# 4. 安装缺失的模块
npm install @rollup/rollup-win32-x64-msvc

# 5. 启动
npm run dev
```

### 方案四：使用 Yarn（可选）
```bash
cd client
start-with-yarn.bat
```

### 方案五：降级 Vite 版本
修改 `package.json`：
```json
"devDependencies": {
  "vite": "^5.0.0"  // 从 ^7.0.4 降级到 ^5.0.0
}
```
然后重新安装：
```bash
npm install
```

## 如果还是不行

### 1. 检查 Node.js 版本
```bash
node --version
```
建议使用 Node.js 18.x 或 20.x，你当前的 22.x 可能太新。

### 2. 使用 pnpm
```bash
npm install -g pnpm
pnpm install
pnpm dev
```

### 3. 直接使用测试页面
如果前端一直无法启动，可以使用项目根目录的 `test-api.html`：
- 双击打开 `test-api.html`
- 功能完整，无需安装依赖

## 预防措施

在 `.npmrc` 文件中添加：
```
legacy-peer-deps=true
```

这样可以避免很多依赖冲突问题。